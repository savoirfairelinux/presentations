<!DOCTYPE html>


<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SFL-Formation InfluxDB</title>

    

    
<link rel="stylesheet" href="_static/css/reveal.min.css">
<link rel="stylesheet" href="_static/css/theme/default.css" id="theme">
<link rel="stylesheet" href="_static/lib/css/zenburn.css">
<link rel="stylesheet" href="_static/revealjs.css" type="text/css" />

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write('<link rel="stylesheet" href="_static/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf.css" type="text/css"' : 'paper.css" type="text/css" media="print"' )  );
    </script>

    <!--[if lt IE 9]>
    <script src="_static/lib/js/html5shiv.js"></script>
    <![endif]-->

  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        
  <section>
<h2>Check Influxdb</h2>
<p class="first">Plugin de monitoring pour InfluxDB 0.9 rc 20</p>
<br/>
<br/><p>Flavien Peyre</p>
<small>
<a class="reference external" href="mailto:flavien&#46;peyre&#37;&#52;&#48;savoirfairelinux&#46;com">flavien<span>&#46;</span>peyre<span>&#64;</span>savoirfairelinux<span>&#46;</span>com</a></small>
<div class="last"><br/>
<br/></div></section>
<section>
<h2>Sommaire</h2>
<div class="first"><br/></div><ul class="last simple">
<li>Présentation de InfluxDB</li>
<li>Comment le monitorer</li>
<li>Plugin</li>
</ul>
</section>
<section>
<section class="first last">
<h2>InfluxDB</h2>
<ul class="first last simple">
<li>Base de données temporelle</li>
<li>Distribuée</li>
<li>Ecrit en Go</li>
<li>Historique de mesures, des logs, des alarmes</li>
<li>Compatibilité avec Grafana</li>
</ul>
</section>
</section>
<section>
<section class="first last">
<h2>Métriques de InfluxDB</h2>
<ul class="first last">
<li><p class="first">Base de données de monitoring</p>
</li>
<li><p class="first">Activation dans la conf</p>
</li>
<li><dl class="first docutils">
<dt>Comprendre et choisir les métriques importantes :</dt>
<dd><ul class="first last simple">
<li>consommation de ressources</li>
<li>Etat d&#8217; InfluxDB</li>
<li>Nombre d&#8217; écriture / lecture</li>
<li>Nombre de série</li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section>
<section class="first">
<h2>Présentation de check_influxdb</h2>
</section>
<section>
<h2>C'est quoi un plugin ?</h2>
<blockquote class="first">
<div><a class="reference internal image-reference" href="_images/nagios.png"><img alt="_images/nagios.png" src="_images/nagios.png" style="width: 300px; height: 300px;" /></a>
</div></blockquote>
<p>Exemple de format de sortie</p>
<div class="last highlight-python"><div class="highlight"><pre>DISK OK - free space: / 3326 MB (56%); | /=2643MB;5948;5958;0;5968
</pre></div>
</div>
</section>
<section>
<h2>Présentation de check_influxdb</h2>
<ul class="first">
<li><p class="first">Codé en python</p>
</li>
<li><p class="first">Utilise python-influxdb pour les requetes (disponible sur pypi)</p>
</li>
<li><dl class="first docutils">
<dt>Renvoi 12 métriques (parametre MODE) différentes :</dt>
<dd><ul class="first last simple">
<li>Consommation de RAM, de ROM</li>
<li>Nombre de lecture/ecriture</li>
<li>Nombre de shard (indique le nombre de série)</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Utilisation</p>
</li>
</ul>
<div class="last highlight-python"><div class="highlight"><pre>check_influxdb  [-h]  [-w WARNING] [-c CRITICAL] [--mode MODE]
</pre></div>
</div>
</section>
<section>
<h2>Utilisation</h2>
<p class="first">Manuel</p>
<div class="last highlight-python"><div class="highlight"><pre>check_influxdb -h
usage: /home/peyre/Monitoring-tools/envNova/bin/check_influxdb
      [-h] [-v] [-w WARNING] [-c CRITICAL] [--mode MODE] [--host HOST]
      [--port PORT] [--timeout TIMEOUT] [--user USER] [--password PASSWORD]
optional arguments:
  -h, --help            show this help message and exit
  -v, --version         show program&#39;s version number and exit
  -w WARNING, --warning WARNING
                        Set the warning threshold
  -c CRITICAL, --critical CRITICAL
                        Set the critical threshold
  --mode MODE, -m MODE  choose type of warning/critical : connection-
                        time, uptime, nb-shards, nb-write-total, write-since-last
                        , nb-read-total, read-since-last, ROM-allocate, RAM-used
                        , ROM-used, continuous-query, routine-go
  --host HOST, -H HOST  The host of influxdb server.
  --port PORT, -p PORT  The port of influxdb server.
  --timeout TIMEOUT, -T TIMEOUT
                        timeout de connection
  --user USER, -u USER  user of the monitoring database
  --password PASSWORD, -P PASSWORD
                        password to access to the monitoring database
</pre></div>
</div>
</section>
<section class="last">
<h2>Utilisation</h2>
<p class="first">Ping</p>
<div class="highlight-python"><div class="highlight"><pre>check_influxdb -w 3 -c 5

OK:all is good for connection-time|&#39;ping=&#39;0.006347ms;3.0;5.0;0.0;10.0
</pre></div>
</div>
<p>Nombre de requete en écriture</p>
<div class="highlight-python"><div class="highlight"><pre>check_influxdb -m nb-write-total -w 200 -c 300

WARNING:nb-write-total &gt; 200|&#39;Number of write queries=&#39;218;200;300;0;
</pre></div>
</div>
<p>Nombre de shards</p>
<div class="last highlight-python"><div class="highlight"><pre>check_influxdb -m nb-shards -w 200 -c 300

OK:all is good for nb-shards|&#39;Number of shards=&#39;4;200;300;0;
</pre></div>
</div>
</section>
</section>
<section>
<h2>Merci</h2>
Github du plugin: <a class="reference external" href="https://github.com/savoirfairelinux/monitoring-tools/tree/master/plugins/check-influxdb/">Check-influxdb</a>.</section>


      </div>
    </div>
    
<script src="_static/js/jquery.min.js"></script>
<script src="_static/lib/js/head.min.js"></script>
<script src="_static/js/reveal.js"></script>
    <script>

      // change DOM for reveal.js
      $("div.section h1").remove();
      var content = $("div.section").html();
      $("div.section").remove();
      $("div.slides").html(content);

      Reveal.initialize({
        width: 960,
        height: 700,

        margin: 0.1,

        minScale: 0.2,
        maxScale: 1.0,

        controls: true,
        progress: true,
        history: true,
        center: true,

        keyboard : true,
        overview: true,
        touch: true,
        loop: false,
        rtl: false,
        fragments: true,

        autoSlide: 0,
        mouseWheel: false,
        rollingLinks: true,
        previewLinks: false,

        transitionSpeed: "default",
        backgroundTransition: "default",

        theme: Reveal.getQueryHash().theme || "sky", // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || "linear", // default/cube/page/concave/zoom/linear/fade/none

        dependencies: [
        { src: '_static/lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: '_static/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: '_static/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: '_static/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: '_static/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
        { src: '_static/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });
    </script>
  </body>
</html>